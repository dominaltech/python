<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="pyBuddy - Run Python instantly in your browser. A beginner-friendly Python coding platform powered by Pyodide.">
    <meta name="keywords" content="python, online python, python editor, pyodide, browser python, learn python">
    <meta name="author" content="Yahya Mundewadi">
    <meta name="theme-color" content="#1a1a1a">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="pyBuddy - Your Python Practice Buddy">
    <meta property="og:description" content="Run Python instantly in your browser">
    <meta property="og:type" content="website">
    
    <!-- Apple Mobile Web App -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="pyBuddy">
    
    <title>pyBuddy - Your Python Practice Buddy</title>
    
    <!-- Pyodide CDN - Latest Stable Version 0.27.0 -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.27.0/full/pyodide.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* ========================================
           CSS STYLES - pyBuddy
           Complete styling for Python IDE
        ======================================== */

        /* === RESET & BASE STYLES === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Color Palette */
            --primary-bg: #0d1117;
            --secondary-bg: #161b22;
            --tertiary-bg: #1a1a1a;
            --card-bg: #21262d;
            --border-color: #30363d;
            --text-primary: #e8e8e8;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-green: #4CAF50;
            --accent-green-hover: #45a049;
            --accent-blue: #58a6ff;
            --accent-yellow: #f9c74f;
            --accent-red: #ff6b6b;
            --console-green: #4ade80;
            --console-yellow: #fbbf24;
            --console-red: #f87171;
            --console-blue: #60a5fa;
            
            /* Spacing */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            
            /* Border Radius */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            
            /* Transitions */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            
            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* === LOADING OVERLAY === */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .loading-content {
            text-align: center;
            padding: var(--spacing-xl);
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--spacing-lg);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-content h2 {
            font-size: 1.5rem;
            margin-bottom: var(--spacing-sm);
            color: var(--accent-green);
        }

        .loading-content p {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        .progress-bar {
            width: 300px;
            height: 4px;
            background: var(--border-color);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin: 0 auto;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-green);
            animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
            0%, 100% { width: 0; }
            50% { width: 100%; }
        }

        /* === AD PLACEHOLDERS === */
        .ad-placeholder {
            background: var(--secondary-bg);
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .ad-top {
            height: 90px;
            margin: var(--spacing-md) var(--spacing-md) 0;
        }

        .ad-sidebar {
            display: none;
            width: 160px;
            height: 600px;
            position: absolute;
            right: -180px;
            top: 0;
        }

        @media (min-width: 1400px) {
            .ad-sidebar {
                display: flex;
            }
        }

        /* === CONTAINER === */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing-md);
        }

        /* === HEADER === */
        .header {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            box-shadow: var(--shadow-md);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .logo-section {
            flex: 1;
            min-width: 250px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        .logo svg {
            flex-shrink: 0;
        }

        .logo-text h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--spacing-xs);
        }

        .tagline {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-left: 56px;
        }

        .header-actions {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        /* === BUTTONS === */
        .btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-family: inherit;
            white-space: nowrap;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--accent-green);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--accent-green-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:active:not(:disabled) {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--border-color);
            border-color: var(--text-muted);
        }

        .btn-small {
            padding: 0.375rem 0.75rem;
            font-size: 0.8rem;
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .btn-small:hover {
            background: var(--card-bg);
            color: var(--text-primary);
            border-color: var(--text-muted);
        }

        .btn-run {
            padding: 0.875rem 2rem;
            font-size: 1.1rem;
            background: linear-gradient(135deg, var(--accent-green), #66bb6a);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .btn-run:hover:not(:disabled) {
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
        }

        .btn-run:disabled {
            background: var(--border-color);
            box-shadow: none;
        }

        /* === MAIN CONTENT === */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        /* === SECTION STYLING === */
        .editor-section,
        .output-section {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-md);
            position: relative;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: var(--spacing-sm);
        }

        .section-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--text-primary);
        }

        .editor-controls,
        .console-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .char-count {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        /* === CODE EDITOR === */
        .editor-wrapper {
            display: flex;
            background: var(--tertiary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            overflow: hidden;
            position: relative;
        }

        .line-numbers {
            background: var(--card-bg);
            color: var(--text-muted);
            padding: var(--spacing-md);
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            user-select: none;
            text-align: right;
            min-width: 50px;
            border-right: 1px solid var(--border-color);
            overflow: hidden;
        }

        .code-editor {
            flex: 1;
            background: var(--tertiary-bg);
            color: var(--text-primary);
            border: none;
            outline: none;
            padding: var(--spacing-md);
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            resize: none;
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
            tab-size: 4;
        }

        .code-editor::placeholder {
            color: var(--text-muted);
        }

        .code-editor::-webkit-scrollbar {
            width: 12px;
        }

        .code-editor::-webkit-scrollbar-track {
            background: var(--card-bg);
        }

        .code-editor::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: var(--radius-sm);
        }

        .code-editor::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* === CONTROL PANEL === */
        .control-panel {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-lg);
            flex-wrap: wrap;
            padding: var(--spacing-md) 0;
        }

        .control-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .execution-time {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* === OUTPUT CONSOLE === */
        .output-console {
            background: var(--tertiary-bg);
            color: var(--console-green);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            min-height: 300px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output-console::-webkit-scrollbar {
            width: 12px;
        }

        .output-console::-webkit-scrollbar-track {
            background: var(--card-bg);
        }

        .output-console::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: var(--radius-sm);
        }

        .output-console::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Console output styling */
        .output-console .error {
            color: var(--console-red);
        }

        .output-console .warning {
            color: var(--console-yellow);
        }

        .output-console .info {
            color: var(--console-blue);
        }

        .output-console .success {
            color: var(--console-green);
        }

        /* === STATUS INDICATORS === */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: 0.8rem;
            color: var(--text-secondary);
            padding: 0.25rem 0.625rem;
            background: var(--card-bg);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-yellow);
            animation: pulse 2s ease-in-out infinite;
        }

        .status-indicator.ready .status-dot {
            background: var(--accent-green);
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .python-version {
            font-size: 0.8rem;
            color: var(--text-muted);
            padding: 0.25rem 0.625rem;
            background: var(--card-bg);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }

        /* === MODAL === */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-md);
            backdrop-filter: blur(4px);
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            max-width: 800px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h3 {
            font-size: 1.5rem;
            color: var(--text-primary);
        }

        .btn-close {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: var(--spacing-sm);
            border-radius: var(--radius-sm);
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-close:hover {
            background: var(--card-bg);
            color: var(--text-primary);
        }

        .samples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: var(--spacing-md);
            padding: var(--spacing-lg);
        }

        .sample-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            cursor: pointer;
            transition: all var(--transition-fast);
            text-align: left;
        }

        .sample-card:hover {
            background: var(--border-color);
            border-color: var(--accent-green);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .sample-card h4 {
            font-size: 1.1rem;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .sample-card p {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* === FOOTER === */
        .footer {
            background: var(--secondary-bg);
            border-top: 1px solid var(--border-color);
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg);
            text-align: center;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer p {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-sm);
        }

        .footer strong {
            color: var(--accent-green);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        .footer-link:hover {
            color: var(--accent-green);
        }

        .separator {
            color: var(--border-color);
        }

        /* === RESPONSIVE DESIGN === */
        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-sm);
            }

            .header {
                padding: var(--spacing-md);
            }

            .logo-text h1 {
                font-size: 1.5rem;
            }

            .subtitle {
                margin-left: 0;
                font-size: 0.8rem;
            }

            .header-actions {
                width: 100%;
                justify-content: stretch;
            }

            .header-actions .btn {
                flex: 1;
                justify-content: center;
            }

            .editor-section,
            .output-section {
                padding: var(--spacing-md);
            }

            .code-editor {
                min-height: 300px;
                font-size: 0.85rem;
            }

            .output-console {
                min-height: 200px;
                font-size: 0.85rem;
            }

            .btn-run {
                width: 100%;
                justify-content: center;
            }

            .control-panel {
                flex-direction: column;
            }

            .control-info {
                width: 100%;
                justify-content: space-between;
            }

            .samples-grid {
                grid-template-columns: 1fr;
            }

            .ad-top {
                height: 60px;
                font-size: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .logo {
                flex-direction: column;
                text-align: center;
            }

            .subtitle {
                text-align: center;
            }

            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .line-numbers {
                min-width: 35px;
                padding: var(--spacing-sm);
                font-size: 0.8rem;
            }

            .code-editor,
            .output-console {
                font-size: 0.8rem;
            }
        }

        /* === UTILITY CLASSES === */
        .hidden {
            display: none !important;
        }

        .text-success {
            color: var(--console-green);
        }

        .text-error {
            color: var(--console-red);
        }

        .text-warning {
            color: var(--console-yellow);
        }

        .text-info {
            color: var(--console-blue);
        }

        /* === ANIMATIONS === */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease;
        }


        /* Console wrapper */
.console-wrapper {
    position: relative;
}

/* Input area at bottom of console */
.input-area {
    display: flex;
    align-items: center;
    background: var(--tertiary-bg);
    border-top: 1px solid var(--border-color);
    padding: var(--spacing-sm) var(--spacing-md);
    gap: var(--spacing-sm);
}

.input-prompt {
    color: var(--accent-green);
    font-family: 'Fira Code', monospace;
    font-weight: bold;
}

.console-input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    padding: 0.25rem;
}

.console-input::placeholder {
    color: var(--text-muted);
}








        /* AI Assistant Box Styles */
        .ai-assistant-box {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-top: var(--spacing-lg);
            box-shadow: var(--shadow-md);
        }

        .ai-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-color);
        }

        .ai-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--accent-green);
        }

        .ai-status {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .ai-status.active {
            color: var(--accent-green);
        }

        .ai-chat-container {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--tertiary-bg);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .ai-message {
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .ai-message.user {
            background: var(--card-bg);
            color: var(--text-primary);
            margin-left: var(--spacing-xl);
            border-left: 3px solid var(--accent-blue);
        }

        .ai-message.assistant {
            background: rgba(76, 175, 80, 0.1);
            color: var(--text-primary);
            margin-right: var(--spacing-xl);
            border-left: 3px solid var(--accent-green);
        }

        .ai-message.error-msg {
            background: rgba(255, 107, 107, 0.1);
            color: var(--console-red);
            border-left: 3px solid var(--console-red);
        }

        .ai-message strong {
            display: block;
            margin-bottom: var(--spacing-xs);
            color: var(--accent-green);
            font-size: 0.85rem;
        }

        .ai-input-area {
            display: flex;
            gap: var(--spacing-sm);
        }

        .ai-input {
            flex: 1;
            background: var(--tertiary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            outline: none;
            transition: border-color var(--transition-fast);
        }

        .ai-input:focus {
            border-color: var(--accent-green);
        }

        .ai-input::placeholder {
            color: var(--text-muted);
        }

        .btn-ai-send {
            background: var(--accent-green);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            padding: var(--spacing-sm) var(--spacing-lg);
            cursor: pointer;
            font-weight: 600;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .btn-ai-send:hover:not(:disabled) {
            background: var(--accent-green-hover);
            transform: translateY(-1px);
        }

        .btn-ai-send:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .ai-quick-actions {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
        }

        .btn-quick-action {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 0.375rem 0.75rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .btn-quick-action:hover {
            background: var(--border-color);
            color: var(--text-primary);
            border-color: var(--accent-green);
        }

        .typing-indicator {
            display: none;
            padding: var(--spacing-sm);
            color: var(--text-muted);
            font-size: 0.85rem;
            font-style: italic;
        }

        .typing-indicator.active {
            display: block;
        }

        @media (max-width: 768px) {
            .ai-message.user {
                margin-left: var(--spacing-sm);
            }
            
            .ai-message.assistant {
                margin-right: var(--spacing-sm);
            }
        }
    </style>
</head>
<body>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2>Loading Python...</h2>
            <p id="loading-status">Initializing runtime</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- Top Ad Placeholder -->
    <div class="ad-placeholder ad-top">
        <span>Advertisement Space</span>
    </div>

    <!-- Main Container -->
    <div class="container">
        
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">
                        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 5L35 12.5V27.5L20 35L5 27.5V12.5L20 5Z" fill="#4CAF50" stroke="#81C784" stroke-width="2"/>
                            <text x="20" y="26" text-anchor="middle" fill="white" font-family="Arial" font-size="16" font-weight="bold">py</text>
                        </svg>
                        <div class="logo-text">
                            <h1>pyBuddy - Python IDE</h1>
                            <p class="tagline">Your Python Practice Buddy</p>
                        </div>
                    </div>
                    <p class="subtitle">Run Python instantly in your browser.</p>
                </div>
                
                <div class="header-actions">
                    <button id="clear-btn" class="btn btn-secondary" title="Clear Editor">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M2 3h12v2H2V3zm1 3h10v9a1 1 0 01-1 1H4a1 1 0 01-1-1V6z"/>
                        </svg>
                        Clear
                    </button>
                    <button id="save-btn" class="btn btn-secondary" title="Save Code">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M2 2h10l2 2v10a1 1 0 01-1 1H3a1 1 0 01-1-1V3a1 1 0 011-1zm8 0v4H6V2H4v12h8V4h-2z"/>
                        </svg>
                        Save
                    </button>
                    <button id="install-btn" class="btn btn-primary install-btn" style="display:none;" title="Install pyBuddy">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 12l-5-5h3V2h4v5h3l-5 5zm-6 2h12v2H2v-2z"/>
                        </svg>
                        Install App
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            
            <!-- Editor Section -->
            <section class="editor-section">
                <div class="section-header">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M5 3l-3 3 3 3V7h6V5H5V3zm10 8l3-3-3-3v2H9v2h6v2z"/>
                        </svg>
                        Python Editor
                    </h2>
                    <div class="editor-controls">
                        <button id="sample-btn" class="btn-small" title="Load Sample Code">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                <path d="M2 2h10v2H2V2zm0 4h10v2H2V6zm0 4h6v2H2v-2z"/>
                            </svg>
                            Samples
                        </button>
                        <span id="char-count" class="char-count">0 characters</span>
                    </div>
                </div>
                
                <div class="editor-wrapper">
                    <!-- Line Numbers -->
                    <div id="line-numbers" class="line-numbers">1</div>
                    
                    <!-- Code Editor -->
                    <textarea 
                        id="code-editor" 
                        class="code-editor" 
                        spellcheck="false"
                        placeholder="# Write your Python code here...&#10;print('Hello, pyBuddy!')"
                        aria-label="Python Code Editor"
                    >print("Welcome to pyBuddy!")
print("Let's write some Python code!")

# Try some basic Python
name = "Coder"
print(f"Hello, {name}!")

# Simple calculation
result = 10 + 20
print(f"10 + 20 = {result}")</textarea>
                </div>

                <!-- Sidebar Ad Placeholder -->
                <div class="ad-placeholder ad-sidebar">
                    <span>Ad Space</span>
                </div>
            </section>

            <!-- Control Panel -->
            <div class="control-panel">
                <button id="run-btn" class="btn btn-run" aria-label="Run Python Code">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M5 3l12 7-12 7V3z"/>
                    </svg>
                    <span id="run-btn-text">Run Code</span>
                </button>
                
                <div class="control-info">
                    <span id="execution-time" class="execution-time"></span>
                    <button id="clear-output-btn" class="btn btn-small" title="Clear Output">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                            <path d="M1 1h12v2H1V1zm0 4h12v2H1V5zm0 4h8v2H1V9z"/>
                        </svg>
                        Clear Output
                    </button>
                </div>
            </div>

            <!-- Output Console -->
            <section class="output-section">
                <div class="section-header">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M2 2h16v14H2V2zm2 2v10h12V4H4zm2 2l2 2-2 2v-4zm4 3h4v1H10V9z"/>
                        </svg>
                        Output Console
                    </h2>
                    <div class="console-status">
                        <span id="python-version" class="python-version"></span>
                        <span id="pyodide-status" class="status-indicator">
                            <span class="status-dot"></span>
                            Initializing...
                        </span>
                    </div>
                </div>
                
               <div class="console-wrapper">
    <pre id="output-console" class="output-console" aria-live="polite" aria-label="Python Output Console">pyBuddy Console v1.0

Ready to run Python code...
</pre>
    <div id="input-area" class="input-area" style="display:none;">
        <span class="input-prompt">>>> </span>
        <input type="text" id="console-input" class="console-input" placeholder="Enter input...">
    </div>
</div>

                <!-- NEW: AI ASSISTANT SECTION -->
            <section class="ai-assistant-box">
                <div class="ai-header">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 2a6 6 0 016 6c0 2.5-1.5 4.5-3.5 5.5v2.5a1 1 0 01-1 1h-3a1 1 0 01-1-1v-2.5C5.5 12.5 4 10.5 4 8a6 6 0 016-6zm0 2a4 4 0 00-4 4c0 1.5 1 3 2.5 3.5.5.2.5.5.5 1v2h2v-2c0-.5 0-.8.5-1C13 11 14 9.5 14 8a4 4 0 00-4-4z"/>
                        </svg>
                        Python AI Assistant
                    </h3>
                    <div class="ai-status" id="ai-status">
                        <span class="status-dot"></span>
                        Connecting...
                    </div>
                </div>

                <div class="ai-quick-actions">
                    <button class="btn-quick-action" onclick="askAI('Explain this code')">ðŸ“– Explain Code</button>
                    <button class="btn-quick-action" onclick="askAI('Fix the error')">ðŸ”§ Fix Error</button>
                    <button class="btn-quick-action" onclick="askAI('Optimize this code')">âš¡ Optimize</button>
                    <button class="btn-quick-action" onclick="askAI('Add comments')">ðŸ’¬ Add Comments</button>
                </div>

                <div class="ai-chat-container" id="ai-chat">
                    <div class="ai-message assistant">
                        <strong>AI Assistant ðŸ¤–</strong>
                        Hello! I'm your Python coding assistant powered by Groq AI. I can help you understand errors, explain code, suggest fixes, and optimize your Python programs. Ask me anything!
                    </div>
                </div>

                <div class="typing-indicator" id="typing-indicator">AI is thinking...</div>

                <div class="ai-input-area">
                    <input 
                        type="text" 
                        class="ai-input" 
                        id="ai-input" 
                        placeholder="Ask me about your Python code..."
                        onkeypress="handleAIEnter(event)"
                    >
                    <button class="btn-ai-send" id="ai-send-btn" onclick="sendAIMessage()">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M15 8L1 1l4 7-4 7 14-7z"/>
                        </svg>
                        Send
                    </button>
                </div>
            </section>

            </section>

            <!-- Sample Code Modal -->
            <div id="samples-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Sample Python Programs</h3>
                        <button id="close-modal" class="btn-close" aria-label="Close Modal">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 8.586l4.95-4.95 1.414 1.414L11.414 10l4.95 4.95-1.414 1.414L10 11.414l-4.95 4.95-1.414-1.414L8.586 10 3.636 5.05l1.414-1.414L10 8.586z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="samples-grid">
                        <button class="sample-card" data-sample="hello">
                            <h4>ðŸ‘‹ Hello World</h4>
                            <p>Basic print statement</p>
                        </button>
                        <button class="sample-card" data-sample="calculator">
                            <h4>ðŸ”¢ Calculator</h4>
                            <p>Simple arithmetic operations</p>
                        </button>
                        <button class="sample-card" data-sample="loop">
                            <h4>ðŸ”„ For Loop</h4>
                            <p>Iterate through numbers</p>
                        </button>
                        <button class="sample-card" data-sample="list">
                            <h4>ðŸ“‹ Lists</h4>
                            <p>Working with Python lists</p>
                        </button>
                        <button class="sample-card" data-sample="function">
                            <h4>âš¡ Functions</h4>
                            <p>Define and call functions</p>
                        </button>
                        <button class="sample-card" data-sample="fibonacci">
                            <h4>ðŸ”¢ Fibonacci</h4>
                            <p>Generate Fibonacci sequence</p>
                        </button>
                        <button class="sample-card" data-sample="prime">
                            <h4>âœ¨ Prime Numbers</h4>
                            <p>Check if number is prime</p>
                        </button>
                        <button class="sample-card" data-sample="dictionary">
                            <h4>ðŸ“– Dictionary</h4>
                            <p>Work with key-value pairs</p>
                        </button>
                    </div>
                </div>
            </div>

        </main>

    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 pyBuddy &mdash; Created by <strong>Yahya Mundewadi</strong></p>
            <div class="footer-links">
                <a href="#" class="footer-link">About</a>
                <span class="separator">|</span>
                <a href="#" class="footer-link">Docs</a>
                <span class="separator">|</span>
                <a href="#" class="footer-link">GitHub</a>
                <span class="separator">|</span>
                <a href="#" class="footer-link">Contact</a>
            </div>
        </div>
    </footer>

    <!-- ========================================
         JAVASCRIPT - pyBuddy
         Complete functionality for Python IDE
    ======================================== -->
        
                                 
        <script>
// ==========================================
// GLOBAL VARIABLES & INITIALIZATION
// ==========================================

let pyodide = null;
let pyodideReady = false;
let deferredPrompt = null;
let autoSaveInterval = null;
let lastError = '';
let lastCode = '';

// DOM Elements
const loadingOverlay = document.getElementById('loading-overlay');
const loadingStatus = document.getElementById('loading-status');
const codeEditor = document.getElementById('code-editor');
const lineNumbers = document.getElementById('line-numbers');
const outputConsole = document.getElementById('output-console');
const runBtn = document.getElementById('run-btn');
const runBtnText = document.getElementById('run-btn-text');
const clearBtn = document.getElementById('clear-btn');
const saveBtn = document.getElementById('save-btn');
const clearOutputBtn = document.getElementById('clear-output-btn');
const sampleBtn = document.getElementById('sample-btn');
const samplesModal = document.getElementById('samples-modal');
const closeModal = document.getElementById('close-modal');
const charCount = document.getElementById('char-count');
const executionTime = document.getElementById('execution-time');
const pyodideStatus = document.getElementById('pyodide-status');
const pythonVersion = document.getElementById('python-version');

// Sample Code Library
const sampleCodes = {
    hello: `# Hello World Program
print("Hello, World!")
print("Welcome to Python programming!")`,
    
    calculator: `# Simple Calculator
a = 15
b = 7
print(f"Addition: {a} + {b} = {a + b}")
print(f"Subtraction: {a} - {b} = {a - b}")
print(f"Multiplication: {a} Ã— {b} = {a * b}")
print(f"Division: {a} Ã· {b} = {a / b:.2f}")
print(f"Modulus: {a} % {b} = {a % b}")
print(f"Power: {a} ^ {b} = {a ** b}")`,
    
    loop: `# For Loop Example
print("Counting from 1 to 10:")
for i in range(1, 11):
    print(f"Number: {i}")

print("\\nEven numbers from 2 to 20:")
for num in range(2, 21, 2):
    print(num, end=" ")
print()`,
    
    list: `# Working with Lists
fruits = ["apple", "banana", "cherry", "date", "elderberry"]

print("Original list:", fruits)
print(f"First fruit: {fruits[0]}")
print(f"Last fruit: {fruits[-1]}")

fruits.append("fig")
print("After adding fig:", fruits)

lengths = [len(fruit) for fruit in fruits]
print("Lengths:", lengths)`,
    
    function: `# Function Examples
def greet(name):
    return f"Hello, {name}! Welcome to pyBuddy!"

def add_numbers(a, b):
    return a + b

def is_even(num):
    return num % 2 == 0

print(greet("Python Learner"))
print(f"5 + 3 = {add_numbers(5, 3)}")
print(f"Is 10 even? {is_even(10)}")
print(f"Is 7 even? {is_even(7)}")`,
    
    fibonacci: `# Fibonacci Sequence Generator
def fibonacci(n):
    fib_sequence = []
    a, b = 0, 1
    for _ in range(n):
        fib_sequence.append(a)
        a, b = b, a + b
    return fib_sequence

n = 15
result = fibonacci(n)
print(f"First {n} Fibonacci numbers:")
print(result)
print(f"\\nSum: {sum(result)}")`,
    
    prime: `# Prime Number Checker
def is_prime(n):
    if n < 2:
        return False
    for i in range(2, int(n ** 0.5) + 1):
        if n % i == 0:
            return False
    return True

print("Prime numbers between 1 and 50:")
primes = [num for num in range(1, 51) if is_prime(num)]
print(primes)
print(f"\\nTotal prime numbers: {len(primes)}")`,
    
    dictionary: `# Dictionary Example
student = {
    "name": "Alice",
    "age": 20,
    "grade": "A",
    "subjects": ["Math", "Physics", "Chemistry"]
}

print("Student Information:")
for key, value in student.items():
    print(f"{key}: {value}")

student["email"] = "alice@example.com"
print("\\nAfter adding email:")
print(student)`
};

// ==========================================
// PYODIDE INITIALIZATION
// ==========================================

async function initPyodide() {
    try {
        loadingStatus.textContent = 'Loading Python runtime...';
        pyodide = await loadPyodide({
            indexURL: 'https://cdn.jsdelivr.net/pyodide/v0.27.0/full/'
        });
        
        loadingStatus.textContent = 'Python loaded successfully!';
        pyodideReady = true;
        
        // Update UI
        pyodideStatus.innerHTML = '<span class="status-dot"></span> Ready';
        pyodideStatus.classList.add('ready');
        pythonVersion.textContent = `Python ${pyodide.version}`;
        
        // Hide loading overlay
        setTimeout(() => {
            loadingOverlay.classList.add('hidden');
        }, 500);
        
        // Load saved code
        loadSavedCode();
        
        // Setup auto-save
        setupAutoSave();
        
        console.log('Pyodide initialized successfully');
        
    } catch (error) {
        loadingStatus.textContent = 'Failed to load Python runtime';
        console.error('Pyodide initialization error:', error);
        appendOutput('Error: Failed to load Python runtime\n' + error.message, 'error');
    }
}

// ==========================================
// CODE EXECUTION
// ==========================================

async function runPythonCode() {
    if (!pyodideReady) {
        appendOutput('âš ï¸ Python is still loading. Please wait...', 'warning');
        return;
    }
    
    const code = codeEditor.value.trim();
    if (!code) {
        appendOutput('âš ï¸ Please write some code first!', 'warning');
        return;
    }
    
    // Update button state
    runBtn.disabled = true;
    runBtnText.textContent = 'Running...';
    
    // Clear previous output
    outputConsole.textContent = '';
    lastError = '';
    lastCode = code;
    
    const startTime = performance.now();
    
    try {
        // Redirect stdout to capture print statements
        pyodide.runPython(`
import sys
from io import StringIO
sys.stdout = StringIO()
sys.stderr = StringIO()
        `);
        
        // Run user code
        pyodide.runPython(code);
        
        // Get output
        const stdout = pyodide.runPython('sys.stdout.getvalue()');
        const stderr = pyodide.runPython('sys.stderr.getvalue()');
        
        const endTime = performance.now();
        const execTime = ((endTime - startTime) / 1000).toFixed(3);
        
        // Display output
        if (stdout) {
            appendOutput(stdout, 'success');
        }
        if (stderr) {
            appendOutput(stderr, 'warning');
        }
        if (!stdout && !stderr) {
            appendOutput('âœ“ Code executed successfully (no output)', 'info');
        }
        
        // Show execution time
        executionTime.textContent = `âš¡ Executed in ${execTime}s`;
        
    } catch (error) {
        const endTime = performance.now();
        const execTime = ((endTime - startTime) / 1000).toFixed(3);
        
        lastError = error.message;
        appendOutput(`âŒ Error:\n${error.message}`, 'error');
        executionTime.textContent = `âš ï¸ Failed in ${execTime}s`;
        
        // Optional: Auto-suggest fix (uncomment to enable)
        // setTimeout(() => autoSuggestFix(error.message), 1000);
        
    } finally {
        // Reset button
        runBtn.disabled = false;
        runBtnText.textContent = 'Run Code';
    }
}

// ==========================================
// OUTPUT MANAGEMENT
// ==========================================

function appendOutput(text, type = 'success') {
    const span = document.createElement('span');
    span.className = type;
    span.textContent = text + '\n';
    outputConsole.appendChild(span);
    outputConsole.scrollTop = outputConsole.scrollHeight;
}

function clearOutput() {
    outputConsole.textContent = 'pyBuddy Console v1.0\n\nReady to run Python code...\n';
    executionTime.textContent = '';
}

// ==========================================
// CODE EDITOR FUNCTIONS
// ==========================================

function updateLineNumbers() {
    const lines = codeEditor.value.split('\n').length;
    lineNumbers.textContent = Array.from({length: lines}, (_, i) => i + 1).join('\n');
}

function updateCharCount() {
    const count = codeEditor.value.length;
    charCount.textContent = `${count} characters`;
}

function clearEditor() {
    if (codeEditor.value.trim() && !confirm('Clear all code? This cannot be undone.')) {
        return;
    }
    codeEditor.value = '';
    updateLineNumbers();
    updateCharCount();
    saveCode();
}

function saveCode() {
    try {
        localStorage.setItem('pybuddy_code', codeEditor.value);
        showToast('ðŸ’¾ Code saved!');
    } catch (error) {
        console.error('Save error:', error);
        showToast('âŒ Failed to save code');
    }
}

function loadSavedCode() {
    try {
        const saved = localStorage.getItem('pybuddy_code');
        if (saved) {
            codeEditor.value = saved;
            updateLineNumbers();
            updateCharCount();
        }
    } catch (error) {
        console.error('Load error:', error);
    }
}

function setupAutoSave() {
    autoSaveInterval = setInterval(() => {
        if (codeEditor.value.trim()) {
            localStorage.setItem('pybuddy_code', codeEditor.value);
        }
    }, 30000); // Auto-save every 30 seconds
}

function showToast(message) {
    // Simple toast notification
    const toast = document.createElement('div');
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: var(--card-bg);
        color: var(--text-primary);
        padding: 1rem 1.5rem;
        border-radius: 8px;
        border: 1px solid var(--border-green);
        z-index: 10000;
        animation: slideIn 0.3s ease;
    `;
    document.body.appendChild(toast);
    setTimeout(() => {
        toast.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => toast.remove(), 300);
    }, 2000);
}

// ==========================================
// SAMPLE CODE MODAL
// ==========================================

function openSamplesModal() {
    samplesModal.classList.add('active');
}

function closeSamplesModal() {
    samplesModal.classList.remove('active');
}

function loadSample(sampleName) {
    if (sampleCodes[sampleName]) {
        codeEditor.value = sampleCodes[sampleName];
        updateLineNumbers();
        updateCharCount();
        closeSamplesModal();
        showToast('ðŸ“ Sample loaded!');
    }
}

// ==========================================
// AI ASSISTANT FUNCTIONS
// ==========================================

function checkAIStatus() {
    const aiStatus = document.getElementById('ai-status');
    if (aiStatus) {
        // Try a test call
        fetch('/.netlify/functions/groq-ai', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                messages: [{ role: 'user', content: 'test' }],
                model: 'llama-3.3-70b-versatile'
            })
        })
        .then(res => res.ok ? res.json() : Promise.reject())
        .then(data => {
            if (data.choices) {
                aiStatus.innerHTML = '<span class="status-dot"></span> Ready';
                aiStatus.classList.add('ready');
            }
        })
        .catch(() => {
            aiStatus.innerHTML = '<span class="status-dot"></span> API Key Missing';
            aiStatus.classList.add('error');
        });
    }
}

function addAIMessage(message, type = 'assistant') {
    const chatContainer = document.getElementById('ai-chat');
    if (!chatContainer) return;
    
    const messageDiv = document.createElement('div');
    messageDiv.className = `ai-message ${type}`;
    
    if (type === 'user') {
        messageDiv.innerHTML = `<strong>You ðŸ‘¤</strong>${message}`;
    } else {
        messageDiv.innerHTML = `<strong>AI Assistant ðŸ¤–</strong>${message}`;
    }
    
    chatContainer.appendChild(messageDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;
}

async function sendAIMessage() {
    const input = document.getElementById('ai-input');
    const sendBtn = document.getElementById('ai-send-btn');
    const message = input.value.trim();
    
    if (!message) return;
    
    addAIMessage(message, 'user');
    input.value = '';
    sendBtn.disabled = true;
    sendBtn.textContent = 'Thinking...';
    
    try {
        const includeCode = message.toLowerCase().includes('code') || 
                           message.toLowerCase().includes('explain') ||
                           message.toLowerCase().includes('fix');
        
        const messages = [
            {
                role: 'system',
                content: `You are a Python coding assistant for pyBuddy IDE built by Team Dominal (Yahya Mundewadi & Amir Rangrez). Keep responses under 150 words. Be concise, friendly, and beginner-focused.`
            }
        ];
        
        if (includeCode && codeEditor.value.trim()) {
            messages.push({
                role: 'user',
                content: `Here's my Python code:\n\`\`\`python\n${codeEditor.value.trim()}\n\`\`\``
            });
        }
        
        if (lastError) {
            messages.push({
                role: 'user',
                content: `Last error: ${lastError}`
            });
        }
        
        messages.push({ role: 'user', content: message });
        
        const response = await fetch('/.netlify/functions/groq-ai', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                messages: messages,
                model: 'llama-3.3-70b-versatile',
                temperature: 0.3,
                max_tokens: 300
            })
        });
        
        if (!response.ok) throw new Error('AI request failed');
        
        const data = await response.json();
        addAIMessage(data.choices[0].message.content, 'assistant');
        
    } catch (error) {
        addAIMessage('Sorry, AI is temporarily unavailable. Please check your API configuration.', 'assistant');
        console.error('AI Error:', error);
    } finally {
        sendBtn.disabled = false;
        sendBtn.textContent = 'Send';
    }
}

function askAI(question) {
    const input = document.getElementById('ai-input');
    if (input) {
        input.value = question;
        sendAIMessage();
    }
}

function handleAIEnter(event) {
    if (event.key === 'Enter') {
        sendAIMessage();
    }
}

async function autoSuggestFix(errorMessage) {
    lastError = errorMessage;
    addAIMessage('I noticed an error. Analyzing...', 'assistant');
    
    try {
        const response = await fetch('/.netlify/functions/groq-ai', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                messages: [
                    {
                        role: 'system',
                        content: 'You are a Python error explainer. Explain errors briefly and suggest fixes in 2-3 sentences.'
                    },
                    {
                        role: 'user',
                        content: `Explain this Python error and suggest a fix:\n${errorMessage}\n\nCode:\n${codeEditor.value.trim()}`
                    }
                ],
                model: 'llama-3.3-70b-versatile',
                temperature: 0.3,
                max_tokens: 200
            })
        });
        
        if (response.ok) {
            const data = await response.json();
            addAIMessage(data.choices[0].message.content, 'assistant');
        }
    } catch (error) {
        console.error('Auto-suggest error:', error);
    }
}

// ==========================================
// EVENT LISTENERS
// ==========================================

// Code Editor Events
codeEditor.addEventListener('input', () => {
    updateLineNumbers();
    updateCharCount();
});

codeEditor.addEventListener('scroll', () => {
    lineNumbers.scrollTop = codeEditor.scrollTop;
});

codeEditor.addEventListener('keydown', (e) => {
    // Tab key support
    if (e.key === 'Tab') {
        e.preventDefault();
        const start = codeEditor.selectionStart;
        const end = codeEditor.selectionEnd;
        codeEditor.value = codeEditor.value.substring(0, start) + '    ' + codeEditor.value.substring(end);
        codeEditor.selectionStart = codeEditor.selectionEnd = start + 4;
        updateLineNumbers();
        updateCharCount();
    }
});

// Button Events
runBtn.addEventListener('click', runPythonCode);
clearBtn.addEventListener('click', clearEditor);
saveBtn.addEventListener('click', saveCode);
clearOutputBtn.addEventListener('click', clearOutput);
sampleBtn.addEventListener('click', openSamplesModal);
closeModal.addEventListener('click', closeSamplesModal);

// Sample Cards
document.querySelectorAll('.sample-card').forEach(card => {
    card.addEventListener('click', () => {
        const sample = card.getAttribute('data-sample');
        loadSample(sample);
    });
});

// Close modal on outside click
samplesModal.addEventListener('click', (e) => {
    if (e.target === samplesModal) {
        closeSamplesModal();
    }
});

// ==========================================
// INITIALIZATION
// ==========================================

document.addEventListener('DOMContentLoaded', () => {
    // Initialize Pyodide
    initPyodide();
    
    // Initialize line numbers and char count
    updateLineNumbers();
    updateCharCount();
    
    // Check AI status
    checkAIStatus();
    
    // Add welcome message to AI chat
    const welcomeMsg = document.querySelector('.ai-message.assistant');
    if (!welcomeMsg) {
        addAIMessage('Hello! I\'m your Python AI assistant. I can help explain code, fix errors, and optimize your programs. Ask me anything!', 'assistant');
    }
});

// Cleanup on page unload
window.addEventListener('beforeunload', () => {
    if (autoSaveInterval) {
        clearInterval(autoSaveInterval);
    }
});

console.log('pyBuddy initialized - Built by Team Dominal (Yahya Mundewadi & Amir Rangrez)');
console.log('Visit: www.dominal.in | www.ai.dominal.in');
</script>


</body>
    </html>
